---
import * as general from 'lucide';
import * as brand from 'simple-icons';

type GeneralName = keyof typeof general;
type BrandName = keyof typeof brand;

type Name = GeneralName | BrandName;

interface Props {
	name: Name;
}

function getPathFromIconName(name: Name) {
	if (Object.hasOwn(general, name)) {
		return getPathFromGeneralIconName(general[name as GeneralName] as general.IconNode);
	}
	if (Object.hasOwn(brand, name)) {
		return getPathFromBrandIconName(brand[name as BrandName] as brand.SimpleIcon);
	}
	throw new Error(`Unknown icon name: ${name}`);
}

function getPathFromGeneralIconName(icon: general.IconNode) {
	const shape = icon[0];
	const attributes = icon[1];
	const nodes = icon[2];
	if (!nodes) {
		return "";
	}
	const inner = nodes.map(([shape, attributes]) => {
			return `<${shape} ${Object.entries(attributes).map(([key, value]) => {
				return `${key}="${value}"`;
			}).join(' ')}></${shape}>`
	}).join('');
	return `<${shape} ${Object.entries(attributes).map(([key, value]) => {
		return `${key}="${value}"`;
	}).join(' ')}>${inner}</${shape}>`;
}

function getPathFromBrandIconName(icon: brand.SimpleIcon) {
	return `<svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="${icon.path}"></path></svg>`;
}
---

<Fragment set:html={getPathFromIconName(Astro.props.name)} />
